{# One line for displaying trips in a table #}
{# Variables : trip, stops, driver #}

<tr class="trip-line row"  {#onclick="location.href='{{ trip.url }}';"#} ><td>
    {# Date et régularité - if reserach has been done with a date, we have a 'date" variable #}
    <div class="col-xs-12">
        {# Wich date to use ? #}
        {% if trip.regular and depDate %}
            {% set dateOfTrip = depDate %}
        {% else %}
            {% set dateOfTrip = trip.nextDateTime %}
        {% endif %}

        {# Date #}
        {% if dateOfTrip|date("Y-m-d") == "now"|date("Y-m-d") %}
            <time datetime='{{ dateOfTrip|date("Y-m-d")}} {{ trip.depTime|date("H:i:s") }}' class="h4">Aujourd'hui - {{ trip.depTime|date('H\\hi') }}</time>
        {% elseif  dateOfTrip|date("Y-m-d") == "tomorrow"|date("Y-m-d") %}
            <time datetime='{{ dateOfTrip|date("Y-m-d")}} {{ trip.depTime|date("H:i:s") }}' class="h4">Demain - {{ trip.depTime|date("H\\hi") }}</time>
        {% else %}
            <time datetime='{{ dateOfTrip|date("Y-m-d")}} {{ trip.depTime|date("H:i:s") }}' class="h4">{{ dateOfTrip|localizeddate('full','full',NULL,NULL,"EEEE d MMMM")|capitalize }} - {{ trip.depTime|date("H\\hi") }}</time>
        {% endif %}

        {# Régulier #}
        {% if trip.regular %}
            <div class="regular-days">
                Tous les {{ trip.days|dayjoin(', ', true) }}.
            </div>
        {% endif %}
    </div>

    {# Zone trajet #}
    <div class="col-xs-4">
        {# Tableau des étapes #}
        {% set depTime = trip.depTime %}
        {% include "components/tripstopstable.html.twig" %}
    </div>

    {# Zone Prix, places, contact#}
    <div  class="col-xs-3 text-center">
        {#    <p class="lead red">{{ trip.initial_places_nb }}<small> places</small></p>
            <p>proposées</p>
            <p class="lead red">{{ trip.price|number_format(0,',','') }}<small> €</small></p>
            <p>par passager</p> #}
        </div>

        {# Zone Conducteur #}
    <div class="col-xs-3">
    {#    <div class='col-xs-6'>
                <img src="{{ driver.photo }}" title="Le conducteur" alt="Photo du conducteur" class="photo-small">
        </div>
        <div class="col-xs-6">
            {{ (driver.sex == 'M') ? 'Le conducteur :' : 'La conductrice :' }}
            <div class="name h4">{{ driver.first_name|title }} {{ driver.last_name|first|upper }}.</div>
            <div class="infos">
                {{ driver.age ? (driver.age ~ ' ans<br>')|raw }}
                {{ driver.city ? (driver.city ~ '<br>')|raw }}

            </div>
        </div> #}
    </div>

    {# Zone actions#}
    {% set tripUrl = app.request.baseUrl ~ trip.url(depDelta, arrDelta) ~ ((trip.regular and depDate) ? ('?date=' ~ dateOfTrip|date("Y-m-d")))  %}

    <div class="col-xs-2 text-center">
        <a class="btn btn-default btn-sm" href="{{ tripUrl }}"><span class="glyphicon glyphicon-circle-arrow-right"></span></a><br>
        <a class="btn btn-default btn-sm" href="{{ path('covoiturage_delete', { 'id': trip.id }) }}"><span class="glyphicon glyphicon-remove"></span></a><br>
        <a class="btn btn-default btn-sm" href="{{ path('covoiturage_edit', { 'id': trip.id }) }}"><span class="glyphicon glyphicon-pencil"></span></a>
    </div>
</td></tr>