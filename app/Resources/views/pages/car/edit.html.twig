{% extends 'base.html.twig' %}

{% block headline %}Entrez votre voiture{% endblock %}

{% block body_start %}
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
    {% include "ComurImageBundle:Form:croppable_image_modal.html.twig" with {'include_jquery': false, 'include_bootstrap': false} %}
{% endblock body_start %}

{% block content %}

    <div class="col-sm-3">
        {% include 'components/user_profile_menu.html.twig' %}
    </div>

    <div class="col-sm-9">

        {{ form_start(form) }}
            {{ form_row(form.brand) }}
            {{ form_row(form.model) }}

            {{ form_rest(form) }}

            <div class="col-sm-4 col-sm-push-4">
                <button class="btn btn-primary" type="submit">{{ 'Enregistrer voiture'|trans }}</button>
            </div>
        {{ form_end(form) }}

    </div>
{% endblock content %}

{% block body_end %}
    <script>
        var $brand = $('#app_car_edit_brand');
        // When brand gets selected ...
        $brand.change(function() {
            // ... retrieve the corresponding form.
            var $form = $(this).closest('form');
            // Simulate form data, but only include the selected sport value.
            var data = {};
            data[$brand.attr('name')] = $brand.val();
            // Submit data via AJAX to the form's action path.
            $.ajax({
                url : $form.attr('action'),
                type: $form.attr('method'),
                data : data,
                success: function(html) {
                    // Replace current position field ...
                    $('#app_car_edit_model').replaceWith(
                            // ... with the returned one from the AJAX response.
                            $(html).find('#app_car_edit_model')
                    );
                }
            });
        });
    </script>
{% endblock body_end %}